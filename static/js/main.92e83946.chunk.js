(this.webpackJsonpcarmen=this.webpackJsonpcarmen||[]).push([[0],{35:function(e,t,a){},36:function(e,t,a){"use strict";a.r(t);var n=a(2),c=a.n(n),r=a(15),s=a.n(r),i=a(6),o=a(1),l=a(3),d=a(12),u=a.n(d),m=a(16),b=a(8),j=a(0);function h(e){var t=e.preset,a=e.presetName,c=e.onClick,r=e.active,s=Object(n.useRef)(null),i=s.current,o=b.a.getInstance(i);return o||(o=new b.a(i,{toggle:"button"})),Object(j.jsx)("div",{className:"col p-1 d-grid",children:Object(j.jsx)("button",{className:"preset btn btn-primary ".concat(r?"active":null),ref:s,id:t,onClick:function(e){c(e)},type:"button",children:"".concat(a)})})}function p(e){var t=e.toast,a=e.setToast,c=e.status,r=e.toastText,s=Object(n.useRef)(null);return Object(n.useEffect)((function(){var e=s.current,a=b.b.getInstance(e);a?t?a.show():a.hide():a=new b.b(e,{autohide:!1})}),[t]),Object(j.jsx)("div",{className:"position-fixed bottom-0 end-0 pe-3 pb-3",children:Object(j.jsxs)("div",{className:"toast hide",role:"status","aria-live":"polite","aria-atomic":"true",ref:s,children:[Object(j.jsxs)("div",{className:"toast-header text-primary",children:[Object(j.jsx)("i",{className:"bi bi-image-fill pe-1"}),Object(j.jsx)("strong",{className:"me-auto",children:"Carmen Uploader"}),Object(j.jsx)("small",{children:c?"Success":"Failure"}),Object(j.jsx)("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:function(){return a(!1)}})]}),Object(j.jsx)("div",{className:"toast-body text-dark",children:r})]})})}var g=function(e){var t=e.filter,a=e.range,n=e.filterList,c=e.onChange,r=null!=a.min?a.min:-100,s=null!=a.max?a.max:100,i=a.step||1,o=a.init||0,l=null!=n[t]?n[t]:o;function d(e){e.target.value=o,e.target.name=e.target.attributes.name.value,c(e,o)}return Object(j.jsx)("div",{className:"col",children:Object(j.jsxs)("div",{className:"row gx-1 hover",children:[Object(j.jsx)("button",{className:"col-3 reset btn-secondary border-0 text-capitalize",name:t,htmlFor:t,onClick:d,children:t}),Object(j.jsx)("div",{className:"col-8",children:Object(j.jsx)("input",{id:t,name:t,"aria-label":t,type:"range",min:r,max:s,step:i,className:"form-range slider pt-2",value:l,onChange:function(e){return c(e,o)}})}),Object(j.jsx)("button",{className:"reset col-1 btn-secondary border-0",type:"button",name:t,onClick:d,children:l})]})})};function f(e){var t,a=e.presetList,n=e.onClick,c=["Grayscale","Invert","Vintage","Lomo","Clarity","Sin City","Sunrise","Cross Process","Orange Peel","Love","Grungy","Jarques","Pinhole","Old Boot","Glowing Sun","Hazy Days","Her Majesty","Nostalgia","Hemingway","Concentrate"],r=[],s=Object(m.a)(["greyscale","invert","vintage","lomo","clarity","sinCity","sunrise","crossProcess","orangePeel","love","grungy","jarques","pinhole","oldBoot","glowingSun","hazyDays","herMajesty","nostalgia","hemingway","concentrate"].entries());try{for(s.s();!(t=s.n()).done;){var i=Object(l.a)(t.value,2),o=i[0],d=i[1],u=a===d;r.push(Object(j.jsx)(h,{preset:d,presetName:c[o],onClick:n,active:u},d))}}catch(b){s.e(b)}finally{s.f()}return r}function x(e){for(var t=e.filterList,a=e.onChange,n={},c={min:-100,init:0,max:100},r=0,s=["brightness","contrast","vibrance","saturation","exposure"];r<s.length;r++){n[s[r]]=c}for(var i={min:0,init:0,max:100},l=0,d=["hue","sepia","noise","sharpen","clip"];l<d.length;l++){n[d[l]]=i}n=Object(o.a)(Object(o.a)({},n),{gamma:{min:0,init:1,max:10,step:.1}});var u=[];for(var m in n)u.push(Object(j.jsx)(g,{filter:m,range:n[m],filterList:t,onChange:a},m));return u}var v=a(5),O=a.n(v),y=a(9);function N(){return(N=Object(y.a)(O.a.mark((function e(t,a){var n,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=9;break}return e.next=3,fetch(t);case 3:return n=e.sent,e.next=6,n.blob();case 6:return(c=e.sent).name=a,e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,t){var a="https://api.imgur.com/3/image/".concat(e),n={method:"GET",headers:{Authorization:"Client-ID ".concat("4c75a4cc2da26a6")},maxRedirects:20};return fetch(a,n).then((function(e){if(!e.ok||e.status<200||e.stauts>=300)throw new Error("Error ".concat(e.status,": ").concat(e.statusText));return e.json()})).then((function(e){if(!/image/.test(e.data.type))throw new Error("Unsupported Filetype: ".concat(e.data.type));t(e.data)}))}function C(e){var t="https://api.imgur.com/3/album/".concat(e),a={method:"GET",headers:{Authorization:"Client-ID ".concat("4c75a4cc2da26a6")},maxRedirects:20};return fetch(t,a).then((function(e){return e.json()})).then((function(e){return e.data.images[0].id})).catch((function(e){return console.error(e)}))}var k=function(e){var t=e.updateCanvas,a=e.editPaneRef,c=Object(n.useState)(""),r=Object(l.a)(c,2),s=r[0],i=r[1],o=Object(n.useState)({}),d=Object(l.a)(o,2),u=d[0],m=d[1],b=Object(n.useState)(!1),h=Object(l.a)(b,2),g=h[0],f=h[1],x=Object(n.useState)({success:!0,text:""}),v=Object(l.a)(x,2),k=v[0],I=v[1],E=Object(n.useRef)(null);function S(e){var a=new FileReader;e&&(i(e.name),a.readAsDataURL(e)),a.onload=function(){var e=a.result.match(/data:.+?;/)[0];if(!/image/.test(e))return I({success:!1,text:"Unsupported Filetype: ".concat(e)}),void f(!0);var n=new Image;n.src=a.result,n.onload=function(){t(n)},I({success:!0,text:""}),f(!1)}}function R(){return(R=Object(y.a)(O.a.mark((function e(){var t,a,n,c,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=E.current,a=t.value){e.next=6;break}return I({success:!1,text:"Must provide an Imgur URL."}),f(!0),e.abrupt("return");case 6:if(n=/\w{7}/g,!(c=/\/gallery\/|\/a\//g).test(a)){e.next=17;break}return r=(r=a.split(c)[1]).substring(0,7),e.next=13,C(r);case 13:r=e.sent,console.log(r),e.next=26;break;case 17:if(!n.test(a)){e.next=22;break}r=a.match(n)[0],console.log(r),e.next=26;break;case 22:return"No Imgur Image ID found. Please use the direct URL to the image.",I({success:!1,text:"No Imgur Image ID found. Please use the direct URL to the image."}),f(!0),e.abrupt("return");case 26:w(r,m).then((function(){I({success:!0,text:""}),f(!1)})).catch((function(e){console.log(e.message),I({success:!1,text:e.message}),f(!0)}));case 27:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){if(console.log(e),!e||e.error)return I({success:!1,text:"Error: ".concat((null===e||void 0===e?void 0:e.error)||"Unknown Error")}),void f(!0);var t=e.link||"",a=e.deletehash||"",n=t.replace(/http(s)?:\/\/(www.)?/g,""),c=Object(j.jsx)("a",{href:t,target:"_blank",rel:"noreferrer",children:n});I({success:!0,text:Object(j.jsxs)("div",{children:["Image uploaded to ",c,". The code to delete it is ",Object(j.jsx)("samp",{children:a}),"."]})}),f(!0)}function U(e){if(console.log(e),!e||!e.success||e.error)return I({success:!1,text:"Error: ".concat((null===e||void 0===e?void 0:e.error)||"Unknown Error")}),void f(!0);I({success:!0,text:"Image successfully deleted."}),f(!0)}return Object(n.useEffect)((function(){(function(e,t){return N.apply(this,arguments)})(u.link,u.id).then((function(e){return S(e)})).catch((function(e){return console.error(e)}))}),[u]),Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(p,{toast:g,setToast:f,status:k.success,toastText:k.text}),Object(j.jsxs)("div",{className:"row my-2 d-flex align-items-end",children:[Object(j.jsxs)("div",{className:"col",children:[Object(j.jsx)("label",{htmlFor:"formImgur",className:"form-label",children:"Import Image from or Upload to Imgur"}),Object(j.jsxs)("div",{className:"btn-group",style:{width:"100%"},children:[Object(j.jsx)("input",{id:"formImgur",ref:E,type:"text",placeholder:"https://imgur.com/...",className:"form-control btn bg-light border-light text-start user-select-auto pe-0",style:{cursor:"text"},"aria-labelledby":"formImgur"}),Object(j.jsx)("button",{type:"button","data-bs-toggle":"dropdown","aria-expanded":"false",className:"btn btn-light dropdown-toggle dropdown-toggle-split",children:Object(j.jsx)("span",{className:"visually-hidden",children:"Dropdown Menu"})}),Object(j.jsx)("ul",{className:"dropdown-menu dropdown-menu-end dropdown-menu-dark",children:Object(j.jsx)("li",{children:Object(j.jsx)("button",{className:"dropdown-item",onClick:function(){var e=E.current.value.match(/\w{15}/);if(!e){return I({success:!1,text:"No delete code found. Paste the 15 character delete code into the text box."}),void f(!0)}(function(e,t){var a="https://api.imgur.com/3/image/".concat(e),n={method:"DELETE",headers:{Authorization:"Client-ID ".concat("4c75a4cc2da26a6")},maxRedirects:20};return fetch(a,n).then((function(e){if(!e.ok||e.status<200||e.stauts>=300)throw new Error("Error ".concat(e.status,": ").concat(e.statusText));return e.json()})).then((function(e){return t(e)}))})(e,U).catch((function(e){console.log(e.message),I({success:!1,text:e.message}),f(!0)}))},children:"Delete previously uploaded image"})})})]})]}),Object(j.jsx)("div",{className:"col col-auto text-center ps-0",children:Object(j.jsxs)("button",{id:"downloadImage",className:"btn btn-primary",type:"submit",onClick:function(){return R.apply(this,arguments)},children:[Object(j.jsx)("i",{className:"d-block d-md-none bi bi-cloud-download"}),Object(j.jsx)("span",{className:"d-none d-md-block",children:"Import from Imgur"})]})}),Object(j.jsx)("div",{className:"col col-auto text-center ps-0",children:Object(j.jsxs)("button",{id:"downloadImage",className:"btn btn-primary",onClick:function(){var e=s?"carmen-edited_"+s:"carmen-edited.jpg",t=a.current.firstChild,n={};n.name=e,n.data=t.toDataURL("image/jpeg",1),I({success:!0,text:Object(j.jsxs)("div",{className:"d-flex align-items-center",children:[" Uploading...",Object(j.jsx)("div",{className:"spinner-border ms-auto",role:"status","aria-hidden":"true"})]})}),f(!0);try{!function(e,t){e.data=e.data.toString().replace(/data:.+?,/,"");for(var a={name:e.name,image:e.data,type:"base64"},n=new FormData,c=0,r=Object.entries(a);c<r.length;c++){var s=Object(l.a)(r[c],2),i=s[0],o=s[1];n.append(i,o)}var d={method:"POST",headers:{Authorization:"Client-ID ".concat("4c75a4cc2da26a6")},maxRedirects:20,body:n};fetch("https://api.imgur.com/3/image",d).then((function(e){return e.json()})).then((function(e){return t(e.data)}))}(n,D)}catch(c){console.log(c),I({success:!1,text:c.message}),f(!0)}},children:[Object(j.jsx)("i",{className:"d-block d-md-none bi bi-cloud-upload"}),Object(j.jsx)("span",{className:"d-none d-md-block",children:"Upload to Imgur"})]})})]}),Object(j.jsxs)("div",{className:"row my-2 d-flex align-items-end",children:[Object(j.jsxs)("div",{className:"col",children:[Object(j.jsx)("label",{htmlFor:"formFile",className:"form-label",children:"Upload Image from Device"}),Object(j.jsx)("input",{className:"form-control",type:"file",id:"formFile",accept:"image/*","aria-labelledby":"formFile",onChange:function(e){S(e.target.files[0])}})]}),Object(j.jsx)("div",{className:"col col-auto text-center ps-0",children:Object(j.jsxs)("button",{id:"downloadImage",className:"btn btn-primary",onClick:function(){var e=s?"carmen-edited_"+s:"carmen-edited.jpg";console.log("Downloading",e);var t=a.current.firstChild,n=document.createElement("a");n.download=e,n.href=t.toDataURL("image/jpeg",1),n.dispatchEvent(new MouseEvent("click"))},children:[Object(j.jsx)("i",{className:"d-block d-md-none bi bi-download"}),Object(j.jsx)("span",{className:"d-none d-md-block",children:"Download Image"})]})})]})]})},I=a.p+"static/media/WP.394371ca.png",E=window.Caman,S=!1,R={},D={},U=0,L=function(){},P=u()((function(e){return L(e)}),1e3);E.Event.listen("processStart",(function(e){S=!0})),E.Event.listen("processComplete",(function(e){S=!1,U=0,JSON.stringify(R)!==JSON.stringify(D)&&P(D)}));var F="#canvas";E(F,(function(){this.render()}));var T=function(){var e=Object(n.useState)(""),t=Object(l.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)({}),s=Object(l.a)(r,2),d=s[0],m=s[1],b=Object(n.useState)(!1),h=Object(l.a)(b,2),p=h[0],g=h[1],v=Object(n.useRef)(null);L=y;var O=Object(n.useRef)(u()((function(e){return y(e)}),100));function y(e){R=e,E(F,(function(){for(var t in console.log("~~~~ UPDATE IMAGE ~~~~"),console.log(e),this.revert(!1),e)this[t]?this[t](e[t]):console.log("~".concat(t,"~ is not a valid filter."));this.render()}))}return Object(n.useEffect)((function(){var e=a;a&&!E.prototype[a]&&(console.log("".concat(a," is not a valid preset.")),c(e=""));var t,n=Object(o.a)({},d);for(var r in d)E.prototype[r]||(console.log("".concat(r," is not a valid filter.")),delete n[r],m(n));e&&(t=Object(i.a)({},e,1)),d!=={}&&(t=Object(o.a)(Object(o.a)({},t),n)),D=t,JSON.stringify(R)!==JSON.stringify(t)&&(console.log(t,R,D,S,U),S||(U&&(S=!0),O.current(t),U+=1))}),[d,a]),Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("div",{id:"editPane",ref:v,className:"edit-pane bg-gray container-lg text-center p-4 lh-1",children:Object(j.jsx)("img",{id:"canvas",alt:"Editing Canvas",className:"img-fluid","aria-label":"Editing Canvas",src:I})}),Object(j.jsx)(k,{updateCanvas:function(e){var t=v.current.firstChild,a=t.getContext("2d");t.width=e.width,t.height=e.height,a.drawImage(e,0,0,e.width,e.height),t.removeAttribute("data-caman-id"),y(D)},editPaneRef:v}),Object(j.jsx)("div",{id:"filterHolder",children:Object(j.jsxs)("div",{id:"filterList",className:"container overflow-hidden bg-dark text-center my-3 p-2",children:[Object(j.jsx)("div",{className:"row row-cols-1 row-cols-md-2 center",children:Object(j.jsx)(x,{filterList:d,onChange:function(e,t){var a,n=e.target.name,c=parseFloat(e.target.value);console.log("Updating",n),c===t?delete(a=Object(o.a)({},d))[n]:a=Object(o.a)(Object(o.a)({},d),{},Object(i.a)({},n,c)),m(a)}})}),Object(j.jsx)("hr",{}),Object(j.jsxs)("div",{className:"py-2",children:[Object(j.jsxs)("button",{className:"btn btn-primary",onClick:function(){return g(!p)},"data-bs-target":"#collapseTarget","data-bs-toggle":"collapse",children:[Object(j.jsx)("i",{className:"px-2 bi "+(p?"bi-chevron-compact-up":"bi-chevron-compact-down")}),"Presets",Object(j.jsx)("i",{className:"px-2 bi "+(p?"bi-chevron-compact-up":"bi-chevron-compact-down")})]}),Object(j.jsx)("div",{className:"collapse pt-2",id:"collapseTarget",children:Object(j.jsx)("div",{className:"row row-cols-2 row-cols-sm-3 row-cols-md-4 row-cols-lg-6 m-1",children:Object(j.jsx)(f,{presetList:a,onClick:function(e){var t=e.target.id;c((function(e){return e===t?"":t}))}})})})]})]})})]})};var A=function(){return Object(j.jsxs)("div",{className:"App container text-light",children:[Object(j.jsxs)("div",{className:"bg-dark px-4 py-1 my-3",children:[Object(j.jsxs)("h1",{className:"text-primary display-2",children:[Object(j.jsx)("i",{className:"bi bi-image-fill"})," Carmen"]}),Object(j.jsxs)("div",{children:["Caman + React ",Object(j.jsx)("span",{className:"vertical-line",children:" "}),"Browser Based Image Editing ",Object(j.jsx)("span",{className:"vertical-line",children:" "}),Object(j.jsx)("a",{href:"http://camanjs.com/",children:"CamanJS"})," ",Object(j.jsx)("span",{className:"vertical-line",children:" "}),Object(j.jsx)("a",{href:"https://github.com/Martination/carmen",children:"GitHub Repo"})]})]}),Object(j.jsx)(T,{}),Object(j.jsxs)("div",{className:"text-center pb-3",children:["\xa9 2021 ",Object(j.jsx)("a",{href:"https://martination.github.io/",children:"Martin Green"})]})]})};a(35);s.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(A,{})}),document.getElementById("root"))}},[[36,1,2]]]);
//# sourceMappingURL=main.92e83946.chunk.js.map